
TOP = ../..
PROG = csh
SRCFILES = alloc.c char.c const.c csh.c dir.c dol.c error.c exec.c exp.c file.c \
	func.c glob.c hist.c init.c lex.c misc.c parse.c printf.c proc.c \
	sem.c set.c str.c time.c

UNUSEDOK = alloc.c char.c const.c csh.c dir.c dol.c error.c exec.c exp.c file.c \
	func.c glob.c hist.c init.c lex.c misc.c parse.c printf.c proc.c \
	sem.c set.c str.c time.c
WARNOK = file.c func.c lex.c proc.c set.c

EXTRAINC = -I../../lib/libc
EXTRACLN = error.h const.h
DEFS=-DBUILTIN -DFILEC -DNLS -DSHORT_STRINGS #-DDEBUG -DJOBDEBUG

export DOINSTALL=yes

include $(TOP)/GNUmakefile.global

const.h: error.h

error.h: error.c
	rm -f $@
	echo '/* Do not edit this file, make creates it. */' > $@
	echo '#ifndef _h_sh_err' >> $@
	echo '#define _h_sh_err' >> $@
	egrep -h 'ERR_' *.c | egrep '^#define' >> $@
	echo '#endif /* _h_sh_err */' >> $@

const.h: const.c 
	rm -f const.h
	echo '/* Do not edit this file, make creates it. */' > const.h	
	${CC} -E ${CFLAGS} const.c | egrep 'Char STR' | \
	    sed -e 's/Char \([a-zA-Z0-9_]*\)\(.*\)/extern Char \1[];/' | \
	    sort >> $@

alloc.o: const.h error.h 


